"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
function formatTime(date, format) {
    if (format === void 0) { format = "yyyy-MM-dd hh:mm:ss"; }
    var obj = {
        "y+": date.getFullYear(),
        "M+": date.getMonth() + 1,
        "d+": date.getDate(),
        "h+": date.getHours(),
        "m+": date.getMinutes(),
        "s+": date.getSeconds(),
    };
    for (var k in obj) {
        if (new RegExp("(" + k + ")").test(format)) {
            var s1 = RegExp.$1;
            var value = strPadStart(String(obj[k]), s1.length, "0");
            value = value.substr(value.length - s1.length);
            format = format.replace(s1, value);
        }
    }
    return format;
}
exports.formatTime = formatTime;
function dateDiff(start, end, format) {
    if (format === void 0) { format = "y年d天 h时m分s秒"; }
    var seconds = ~~((end.getTime() - start.getTime()) / 1000);
    var obj = {
        "s+": seconds % 60,
        "m+": ~~(seconds / 60) % 60,
        "h+": ~~(seconds / (60 * 60)) % 24,
        "d+": (function () {
            var day = ~~(seconds / (60 * 60 * 24));
            return /y+/.test(format) ? day % 365 : day;
        })(),
        "y+": ~~(seconds / (60 * 60 * 24 * 365)),
    };
    for (var k in obj) {
        if (new RegExp("(" + k + ")").test(format)) {
            var s1 = RegExp.$1;
            var value = strPadStart(String(obj[k]), s1.length, "0");
            value = value.substr(value.length - s1.length);
            format = format.replace(s1, value);
        }
    }
    return format;
}
exports.dateDiff = dateDiff;
function strPadStart(target, len, fill) {
    if (target.length >= len)
        return target;
    var lessLen = len - target.length;
    while (fill.length < lessLen) {
        fill += fill;
    }
    fill = fill.substr(0, lessLen);
    return fill + target;
}
exports.strPadStart = strPadStart;
function debounce(callback, delay) {
    var timer = null;
    return function () {
        var _this = this;
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        if (timer) {
            clearTimeout(timer);
            timer = null;
        }
        timer = setTimeout(function () {
            timer = null;
            callback.apply(_this, args);
        }, delay);
    };
}
exports.debounce = debounce;
function forEachByLen(len, callback) {
    for (var i = 0; i < len; i++) {
        if (callback(i) !== false)
            continue;
        break;
    }
}
exports.forEachByLen = forEachByLen;
function randomNumber(start, end, length) {
    if (!arguments.length)
        return Math.random();
    if (arguments.length === 1) {
        end = start;
        start = 0;
    }
    if (length === undefined) {
        var len = end - start + 1;
        return ~~(Math.random() * len) + start;
    }
    else {
        var arr_1 = [];
        forEachByLen(length, function () { return arr_1.push(randomNumber(start, end)); });
        return arr_1;
    }
}
exports.randomNumber = randomNumber;
function getUUID(length) {
    var uuidArr = [];
    var hexDigits = "0123456789abcdef";
    for (var i = 0; i < length; i++) {
        uuidArr[i] = hexDigits.substr(Math.random() * 0x10, 1);
    }
    uuidArr[14] = "4";
    uuidArr[19] = hexDigits.substr((uuidArr[19] & 0x3) | 0x8, 1);
    return uuidArr.join("");
}
exports.getUUID = getUUID;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInV0aWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxTQUFnQixVQUFVLENBQUMsSUFBVSxFQUFFLE1BQXNDO0lBQXRDLHVCQUFBLEVBQUEsOEJBQXNDO0lBQ3pFLElBQUksR0FBRyxHQUFRO1FBQ1gsSUFBSSxFQUFFLElBQUksQ0FBQyxXQUFXLEVBQUU7UUFDeEIsSUFBSSxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQUUsR0FBRyxDQUFDO1FBQ3pCLElBQUksRUFBRSxJQUFJLENBQUMsT0FBTyxFQUFFO1FBQ3BCLElBQUksRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFFO1FBQ3JCLElBQUksRUFBRSxJQUFJLENBQUMsVUFBVSxFQUFFO1FBQ3ZCLElBQUksRUFBRSxJQUFJLENBQUMsVUFBVSxFQUFFO0tBQzFCLENBQUM7SUFDRixLQUFLLElBQUksQ0FBQyxJQUFJLEdBQUcsRUFBRTtRQUNmLElBQUksSUFBSSxNQUFNLENBQUMsR0FBRyxHQUFHLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFDeEMsSUFBTSxFQUFFLEdBQUcsTUFBTSxDQUFDLEVBQUUsQ0FBQztZQUNyQixJQUFJLEtBQUssR0FBRyxXQUFXLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxNQUFNLEVBQUUsR0FBRyxDQUFDLENBQUM7WUFDeEQsS0FBSyxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLE1BQU0sR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDL0MsTUFBTSxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsRUFBRSxFQUFFLEtBQUssQ0FBQyxDQUFDO1NBQ3RDO0tBQ0o7SUFDRCxPQUFPLE1BQU0sQ0FBQztBQUNsQixDQUFDO0FBbEJELGdDQWtCQztBQUdELFNBQWdCLFFBQVEsQ0FBQyxLQUFX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QztJQUM3QixJQUFNLFNBQVMsR0FBRyxrQkFBa0IsQ0FBQztJQUNyQyxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO1FBQzdCLE9BQU8sQ0FBQyxDQUFDLENBQUMsR0FBRyxTQUFTLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUM7S0FDMUQ7SUFDRCxPQUFPLENBQUMsRUFBRSxDQUFDLEdBQUcsR0FBRyxDQUFDO0lBQ2xCLE9BQU8sQ0FBQyxFQUFFLENBQUMsR0FBRyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUUsT0FBTyxDQUFDLEVBQUUsQ0FBUyxHQUFHLEdBQUcsQ0FBQyxHQUFHLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUV0RSxPQUFPLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7QUFDNUIsQ0FBQztBQVZELDBCQVVDIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdFRpbWUoZGF0ZTogRGF0ZSwgZm9ybWF0OiBzdHJpbmcgPSBcInl5eXktTU0tZGQgaGg6bW06c3NcIik6IHN0cmluZyB7XG4gICAgbGV0IG9iajogYW55ID0ge1xuICAgICAgICBcInkrXCI6IGRhdGUuZ2V0RnVsbFllYXIoKSxcbiAgICAgICAgXCJNK1wiOiBkYXRlLmdldE1vbnRoKCkgKyAxLCAgICAgICAgICAgICAgICAgICAgLy/mnIjku71cbiAgICAgICAgXCJkK1wiOiBkYXRlLmdldERhdGUoKSwgICAgICAgICAgICAgICAgICAgICAgICAgLy/ml6VcbiAgICAgICAgXCJoK1wiOiBkYXRlLmdldEhvdXJzKCksICAgICAgICAgICAgICAgICAgICAgICAgLy/lsI/ml7ZcbiAgICAgICAgXCJtK1wiOiBkYXRlLmdldE1pbnV0ZXMoKSwgICAgICAgICAgICAgICAgICAgICAgLy/liIZcbiAgICAgICAgXCJzK1wiOiBkYXRlLmdldFNlY29uZHMoKSwgICAgICAgICAgICAgICAgICAgICAgLy/np5JcbiAgICB9O1xuICAgIGZvciAobGV0IGsgaW4gb2JqKSB7XG4gICAgICAgIGlmIChuZXcgUmVnRXhwKFwiKFwiICsgayArIFwiKVwiKS50ZXN0KGZvcm1hdCkpIHtcbiAgICAgICAgICAgIGNvbnN0IHMxID0gUmVnRXhwLiQxO1xuICAgICAgICAgICAgbGV0IHZhbHVlID0gc3RyUGFkU3RhcnQoU3RyaW5nKG9ialtrXSksIHMxLmxlbmd0aCwgXCIwXCIpO1xuICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS5zdWJzdHIodmFsdWUubGVuZ3RoIC0gczEubGVuZ3RoKTtcbiAgICAgICAgICAgIGZvcm1hdCA9IGZvcm1hdC5yZXBsYWNlKHMxLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZvcm1hdDtcbn1cblxuLy8g5q+U6L6D5Lik5Liq5pel5pyf55u45beu5bm05aSp5pe25YiG56eSICDnlKjkuo7lgJLorqHml7bnrYlcbmV4cG9ydCBmdW5jdGlvbiBkYXRlRGlmZihzdGFydDogRGF0ZSwgZW5kOiBEYXRlLCBmb3JtYXQ6IHN0cmluZyA9IFwieeW5tGTlpKkgaOaXtm3liIZz56eSXCIpOiBzdHJpbmcge1xuICAgIGNvbnN0IHNlY29uZHMgPSB+figoZW5kLmdldFRpbWUoKSAtIHN0YXJ0LmdldFRpbWUoKSkgLyAxMDAwKTtcbiAgICBjb25zdCBvYmo6IHsgW2s6IHN0cmluZ106IG51bWJlciB9ID0ge1xuICAgICAgICBcInMrXCI6IHNlY29uZHMgJSA2MCxcbiAgICAgICAgXCJtK1wiOiB+fihzZWNvbmRzIC8gNjApICUgNjAsXG4gICAgICAgIFwiaCtcIjogfn4oc2Vjb25kcyAvICg2MCAqIDYwKSkgJSAyNCxcbiAgICAgICAgXCJkK1wiOiAoZnVuY3Rpb24oKTogbnVtYmVyIHtcbiAgICAgICAgICAgIGNvbnN0IGRheSA9IH5+KHNlY29uZHMgLyAoNjAgKiA2MCAqIDI0KSk7XG4gICAgICAgICAgICAvLyDlpoLmnpzopoHmmL7npLrlubTvvIzliJnmiorlpKnkvZnlubTvvIzlkKbliJnlhajpg6jmmL7npLrlpKlcbiAgICAgICAgICAgIC8vIOm7mOiupOS4gOW5tOetieS6jjM2NeWkqVxuICAgICAgICAgICAgcmV0dXJuIC95Ky8udGVzdChmb3JtYXQpID8gZGF5ICUgMzY1IDogZGF5O1xuICAgICAgICB9KSgpLFxuICAgICAgICAvLyBcIk0rXCI6IDAsXG4gICAgICAgIFwieStcIjogfn4oc2Vjb25kcyAvICg2MCAqIDYwICogMjQgKiAzNjUpKSxcbiAgICB9O1xuXG4gICAgZm9yIChsZXQgayBpbiBvYmopIHtcbiAgICAgICAgaWYgKG5ldyBSZWdFeHAoXCIoXCIgKyBrICsgXCIpXCIpLnRlc3QoZm9ybWF0KSkge1xuICAgICAgICAgICAgY29uc3QgczEgPSBSZWdFeHAuJDE7XG4gICAgICAgICAgICBsZXQgdmFsdWUgPSBzdHJQYWRTdGFydChTdHJpbmcob2JqW2tdKSwgczEubGVuZ3RoLCBcIjBcIik7XG4gICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnN1YnN0cih2YWx1ZS5sZW5ndGggLSBzMS5sZW5ndGgpO1xuICAgICAgICAgICAgZm9ybWF0ID0gZm9ybWF0LnJlcGxhY2UoczEsIHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZm9ybWF0O1xufVxuXG4vKipcbiAqIOe7memVv+W6puS4jea7oei2s+imgeaxgueahOWtl+espuS4sua3u+WKoOWJjee8gCBzdHJGaWxsUHJlZml4XG4gKiBAcGFyYW0gdGFyZ2V0XG4gKiBAcGFyYW0gbGVuXG4gKiBAcGFyYW0gZmlsbFxuICovXG5leHBvcnQgZnVuY3Rpb24gc3RyUGFkU3RhcnQodGFyZ2V0OiBzdHJpbmcsIGxlbjogbnVtYmVyLCBmaWxsOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGlmICh0YXJnZXQubGVuZ3RoID49IGxlbikgcmV0dXJuIHRhcmdldDtcbiAgICBjb25zdCBsZXNzTGVuID0gbGVuIC0gdGFyZ2V0Lmxlbmd0aDtcbiAgICB3aGlsZSAoZmlsbC5sZW5ndGggPCBsZXNzTGVuKSB7XG4gICAgICAgIGZpbGwgKz0gZmlsbDtcbiAgICB9XG4gICAgZmlsbCA9IGZpbGwuc3Vic3RyKDAsIGxlc3NMZW4pO1xuICAgIHJldHVybiBmaWxsICsgdGFyZ2V0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVib3VuY2UoY2FsbGJhY2s6ICguLi5hcmdzOiBhbnlbXSkgPT4gdm9pZCwgZGVsYXk6IG51bWJlcikge1xuICAgIGxldCB0aW1lcjogYW55ID0gbnVsbDtcbiAgICByZXR1cm4gZnVuY3Rpb24odGhpczogYW55LCAuLi5hcmdzOiBhbnlbXSkge1xuICAgICAgICBpZiAodGltZXIpIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7XG4gICAgICAgICAgICB0aW1lciA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHRpbWVyID0gbnVsbDtcbiAgICAgICAgICAgIGNhbGxiYWNrLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICB9LCBkZWxheSk7XG4gICAgfTtcbn1cblxuLy8g5Luj5pu/Zm9y5b6q546vXG5leHBvcnQgZnVuY3Rpb24gZm9yRWFjaEJ5TGVuKGxlbjogbnVtYmVyLCBjYWxsYmFjazogKGluZGV4OiBudW1iZXIpID0+IGFueSB8IGZhbHNlKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBpZiAoY2FsbGJhY2soaSkgIT09IGZhbHNlKSBjb250aW51ZTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxufVxuXG4vLyBzdGFydCBlbmTpg73kuI3kvKAgIHJldHVybiBNYXRoLnJhbmRvbSgpXG5leHBvcnQgZnVuY3Rpb24gcmFuZG9tTnVtYmVyKCk6IG51bWJlclxuLy8gc3RhcnQgPSAwIOeUn+aIkDAtZW5k5LmL6Ze055qE6ZqP5py65pWwXG5leHBvcnQgZnVuY3Rpb24gcmFuZG9tTnVtYmVyKGVuZDogbnVtYmVyKTogbnVtYmVyXG4vLyDnlJ/miJBzdGFydOWIsGVuZOS5i+mXtOeahOmaj+acuuaVsCDljIXlkKtzdGFydOS4jmVuZFxuZXhwb3J0IGZ1bmN0aW9uIHJhbmRvbU51bWJlcihzdGFydDogbnVtYmVyLCBlbmQ6IG51bWJlcik6IG51bWJlclxuLy8g55Sf5oiQc3RhcnTliLBlbmTkuYvpl7TnmoTpmo/mnLrmlbDnu4Qg5YyF5ZCrc3RhcnTkuI5lbmQgbGVuZ3Ro77ya5pWw57uE6ZW/5bqmXG5leHBvcnQgZnVuY3Rpb24gcmFuZG9tTnVtYmVyKHN0YXJ0OiBudW1iZXIsIGVuZDogbnVtYmVyLCBsZW5ndGg6IG51bWJlcik6IG51bWJlcltdXG5leHBvcnQgZnVuY3Rpb24gcmFuZG9tTnVtYmVyKHN0YXJ0PzogYW55LCBlbmQ/OiBhbnksIGxlbmd0aD86IGFueSkge1xuICAgIC8vIHJhbmRvbU51bWJlcigpXG4gICAgaWYgKCFhcmd1bWVudHMubGVuZ3RoKSByZXR1cm4gTWF0aC5yYW5kb20oKTtcbiAgICAvLyByYW5kb21OdW1iZXIoZW5kKVxuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIGVuZCA9IHN0YXJ0O1xuICAgICAgICBzdGFydCA9IDA7XG4gICAgfVxuXG4gICAgLy8gcmFuZG9tTnVtYmVyKHN0YXJ0LCBlbmQpXG4gICAgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGNvbnN0IGxlbiA9IChlbmQgYXMgbnVtYmVyKSAtIChzdGFydCBhcyBudW1iZXIpICsgMTtcbiAgICAgICAgcmV0dXJuIH5+KE1hdGgucmFuZG9tKCkgKiBsZW4pICsgKHN0YXJ0IGFzIG51bWJlcik7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gcmFuZG9tTnVtYmVyKHN0YXJ0LCBlbmQsIGxlbmd0aClcbiAgICAgICAgY29uc3QgYXJyOiBudW1iZXJbXSA9IFtdO1xuICAgICAgICBmb3JFYWNoQnlMZW4obGVuZ3RoLCAoKSA9PiBhcnIucHVzaChyYW5kb21OdW1iZXIoc3RhcnQsIGVuZCkpKTtcbiAgICAgICAgcmV0dXJuIGFycjtcbiAgICB9XG59XG5cbi8qKlxuICog55Sf5oiQ5LiN6YeN5aSN55qE5a2X56ym5LiyXG4gKiBAcGFyYW0gbGVuZ3RoXG4gKiBAcmV0dXJucyB7c3RyaW5nfVxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0VVVJRChsZW5ndGg6IG51bWJlcik6IHN0cmluZyB7XG4gICAgY29uc3QgdXVpZEFycjogc3RyaW5nW10gPSBbXTtcbiAgICBjb25zdCBoZXhEaWdpdHMgPSBcIjAxMjM0NTY3ODlhYmNkZWZcIjtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHV1aWRBcnJbaV0gPSBoZXhEaWdpdHMuc3Vic3RyKE1hdGgucmFuZG9tKCkgKiAweDEwLCAxKTtcbiAgICB9XG4gICAgdXVpZEFyclsxNF0gPSBcIjRcIjsgIC8vIGJpdHMgMTItMTUgb2YgdGhlIHRpbWVfaGlfYW5kX3ZlcnNpb24gZmllbGQgdG8gMDAxMFxuICAgIHV1aWRBcnJbMTldID0gaGV4RGlnaXRzLnN1YnN0cigoKHV1aWRBcnJbMTldIGFzIGFueSkgJiAweDMpIHwgMHg4LCAxKTsgIC8vIGJpdHMgNi03IG9mIHRoZSBjbG9ja19zZXFfaGlfYW5kX3Jlc2VydmVkIHRvIDAxXG5cbiAgICByZXR1cm4gdXVpZEFyci5qb2luKFwiXCIpO1xufVxuXG5cbmV4cG9ydCBpbnRlcmZhY2UgUXVlc3Rpb25MaXN0SXRlbSB7XG4gICAgcXVlc3Rpb246IHN0cmluZyxcbiAgICBhbnN3ZXI6IHN0cmluZyxcbiAgICBkZXNjPzogc3RyaW5nLFxuICAgIGlzVW5DaGVja2VkPzogYm9vbGVhbixcbiAgICBpc01hcms/OiBib29sZWFuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWVtb3J5IHtcbiAgICB0aXRsZTogc3RyaW5nLFxuICAgIGRlc2M/OiBzdHJpbmcsXG4gICAgcXVlc3Rpb25MaXN0OiBRdWVzdGlvbkxpc3RJdGVtW10sXG4gICAgY3JlYXRlVGltZTogc3RyaW5nLFxuICAgIHVwZGF0ZVRpbWU6IHN0cmluZyxcbiAgICB1dWlkOiBzdHJpbmcsXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGxheVNldHRpbmcge1xuICAgIGNhbkp1bXA6IGJvb2xlYW4sXG4gICAgY2FuU2hvd0Fuc3dlcjogYm9vbGVhbixcbiAgICBpc1JldmVyc2U6IGJvb2xlYW4sXG4gICAgdGltZT86IG51bWJlcixcbiAgICB0b3RhbFRpbWU/OiBudW1iZXIsXG4gICAgLy8g5b+955Wl5aSn5bCP5YaZXG4gICAgaWdub3JlVXBMb3c6IGJvb2xlYW4sXG59Il19